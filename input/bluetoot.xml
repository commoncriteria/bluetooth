<?xml version="1.0" encoding="utf-8"?>
<?xsl-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>

<?xml-model href="https://github.com/commoncriteria/transforms/raw/master/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>


<Module boilerplate="yes" target-products="Widgets" name="Widgets" 
	xmlns="https://niap-ccevs.org/cc/v1"
	xmlns:sec="https://niap-ccevs.org/cc/v1/section"
	xmlns:h="http://www.w3.org/1999/xhtml">
  <PPReference>
    <ReferenceTable>
      <PPVersion>1.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2020-01-16</PPPubDate>
      <Keywords>widgets</Keywords>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>
    <entry>
      <version>1.0</version>
      <date>2016-10-06</date>
      <subject>Initial Release </subject>
    </entry>
  </RevisionHistory>
  <sec:Introduction>
    <sec:Overview>
      This Protection Profile Module (PP-Module) describes security requirements for Widgets. 
      This PP-Module is intended to provide a minimal baseline set of requirements that
      are targeted at mitigating well defined and described threats. 
      <h:p>This PP-Module contains optional requirements for Widgets, a security
      product that provides something.
      </h:p>
    </sec:Overview>
    <tech-terms>
      <term abbr="AES" full="Advanced Encryption Standard"/>
      <term abbr="AP" full="Access Point"> 
        A device that provides the network interface that enables
        wireless client hosts to access a wired network. </term>
      <term abbr="BSSID" full="Basic Service Set Identifier"/>
      <term abbr="DoS" full="Denial of Service"/>
      <term abbr="EUD" full="End User Device"> 
        A device that has the ability to process, transmit,
        and/or store information. </term>
      <term abbr="HTTPS" full="Hypertext Transfer Protocol Secure"/>
      <term abbr="IPsec" full="Internet Protocol Security"/>
      <term abbr="MAC" full="Media Access Control"/>
      <term abbr="SSH" full="Secure Shell"/>
      <term abbr="SSID" full="Service Set Identifier"> 
        The primary name associated with an 802.11
        wireless local area network (WLAN). </term>
      <term abbr="TLS" full="Transport Layer Security"/>
      <term abbr="TKIP" full="Temporal Key Integrity Protocol"/>
      <term abbr="WEP" full="Wired Equivalent Protocol"/>
      <term abbr="WIDS" full="Wireless Intrustion Detection System"> 
        A security product that
        provides network security administrators with the ability to monitor, collect, and log
        real-time to potentially malicious wireless (IEEE 802.11) network traffic. </term>
      <term abbr="WIPS" full="Wireless Intrustion Prevention System"> 
        A security product that
        provides network security administrators with the ability to monitor, collect, log, and
        react in real-time to potentially malicious wireless (IEEE 802.11) network traffic. </term>
      <term abbr="WLAN" full="Wireless Local Area Network"> 
        A wireless computer network that links
        two or more devices using wireless communication to form a local area network (LAN) within a
        limited area such as a home, school, computer laboratory, campus, office building etc. </term>
      <term abbr="WPA" full="Wi-Fi Protected Access"/>
    </tech-terms>
    <sec:Compliant_Targets_of_Evaluation>
      <sec:TOE_Boundary>
        <h:p>
        This PP-Module specifically addresses widgets.
        Wireless Intrusion Detection/Prevention Systems (WIDS/WIPS). 
        </h:p>
        <h:p><depends><base-ref>Network Device</base-ref></depends>
          Text specific to widgets when Newtork Device is the base.
        </h:p>
        <h:p>

       A conformant WIDS is a product
        that can monitor, collect, inspect, and analyze real-time network traffic and alert the
        administrator of policy violations. WIPS functionality is not required to conform to this
        PP-Module, and it is optional for the TOE to have the additional ability to react in
        real-time to potentially malicious wireless (IEEE 802.11) network traffic.
        </h:p>
        A
        WIDS/WIPS TOE consists of multiple sensors that passively scan the RF environment on the
        WLAN radio frequency spectrum and a centralized mechanism such as a Server or Controller
        that processes the data collected by the sensors. Conformant TOEs must use a secure
        communication path(s) between WIDS/WIPS components. <h:br/><h:br/> A WIDS/WIPS can be
        Integrated (be part of the WLAN infrastructure) or Overlay (independent from WLAN)
        architecture depending on vendor implementation. The two different architectures are
        illustrated in the <xref to="toe"/> figure below. <h:br/><h:br/> A WIDS/WIPS is
        expected to inspect layers 1 and 2 network traffic, per the OSI network model and monitor
        wireless frames in the RF spectrum utilized by IEEE 802.11 a, b, g, n, and ac. Monitoring
        and inspection of other technologies (e.g., cellular) and protocols are
        optional.<h:br/><h:br/> Conformant TOEs will detect potentially malicious network traffic
        using various approaches. Broadly speaking, the traffic analysis could be based on
        identification of ‘known’ threats, or ‘unknown’ threats. Identification of ‘known’ threats
        may be performed through pattern matching, (e.g. by matching strings of characters within a
        frame with known patterns, or by matching traffic patterns common with reconnaissance or
        denial of service (DoS) attacks). Identification of ‘unknown’ threats may be performed
        through use of various forms of anomaly detection whereby the WIDS/WIPS is provided with (or
        learns/creates) a definition of expected/typical traffic patterns, such that it’s able to
        detect and react to anomalous (unexpected/atypical) traffic patterns.<h:br/><h:br/>
        <figure entity="images/Toe.png" title="General TOE" id="toe"/>
      </sec:TOE_Boundary>
    </sec:Compliant_Targets_of_Evaluation>
    <sec:Use_Cases>
      <usecases>
        <usecase id="usecase1" title="Use Case 1">
          <description/>
        </usecase>
      </usecases>
    </sec:Use_Cases>
  </sec:Introduction>
  <sec:Conformance_Claims>
    <cclaims>
      <cclaim name="Conformance Statement">
        <description> This PP-Module inherits exact conformance as required from the specified
          Base-PP and as defined in the CC and CEM addenda for Exact Conformance, Selection-Based
          SFRs, and Optional SFRs (dated May 2017).<h:br/><h:br/> The following PPs and PP-Modules
          are allowed to be specified in a PP-Configuration with this PP-Module. <h:ul>
            <h:li>Network Device cPP, version 2.1</h:li>
          </h:ul>
        </description>
      </cclaim>
      <cclaim name="CC Conformance Claims">
        <description>This PP-Module is conformant to Parts 2 (extended) and 3 (conformant) of Common
          Criteria Version 3.1, Release 5 [CC]. </description>
      </cclaim>
      <cclaim name="Package Claims">
        <description><!-- Later_NIAP: Does this module need to claim any packages? If YES: This PP-Module is <package name> Conformant. --> 
          This PP-Module does not claim conformance to any packages.</description>
      </cclaim>
    </cclaims>
  </sec:Conformance_Claims>
  <sec:Security_Problem_Description>
    <h:p>WIDS address a range of security threats related to detection of and reaction to potentially malicious WLAN traffic. The malicious
    traffic may pose a threat to one or more endpoints on the monitored networks, to the network
    infrastructure, or to the TOE itself. Attacks against a WLAN could compromise the
    confidentiality and integrity of WLAN users and system data as well as the availability of the
    WLAN to legitimate users.</h:p>
    <section title="Threats" id="threats">
      <threats>
        <threat name="T.UNAUTHORIZED_DISCLOSURE_OF_INFORMATION">
          <description> Unintended/unauthorized disclosure of sensitive information on a protected
            WLAN, such as sending unencrypted sensitive data. The WIDS will be capable of collecting
            and analyzing WLAN data to detect unauthorized disclosure of information. </description>
           <consistency-rationale> This threat is consistent with <base-name/> </consistency-rationale>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by
              O.SYSTEM_MONITORING as this provides for visibility into the network which enables
              detection of network violations.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by
              O.WIDS_ANALYZE as this provides detection of potential violations of approved network
              usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.Unauthorized_Disclosure_of_Information is countered by
              O.WIPS_REACT as this provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.UNAUTHORIZED_ACCESS">
          <description> An attacker may attempt to gain unauthorized access to a network, endpoints,
            or services, by methods such as impersonation of an authorized AP to get an EUD to
            connect to the unauthorized AP If malicious external APs or EUDs are able to communicate
            with APs or EUDs on the protected WLAN, then those devices may be susceptible to the
            unauthorized disclosure of information. </description>
           <consistency-rationale> This threat is consistent with <base-name/> </consistency-rationale>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.SYSTEM_MONITORING as this
              provides for visibility into the network which enables detection of unauthorized APs
              and EUDs.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIDS_ANALYZE as this
              provides detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by O.WIPS_REACT as this
              provides containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
          <objective-refer ref="O.TOE_ADMINISTRATION">
            <rationale>The threat T.UNAUTHORIZED_ACCESS is countered by
              O.TOE_ADMINISTRATION.</rationale>
          </objective-refer>
        </threat>
        <threat name="T.DISRUPTION">
          <description> Attacks against the WLAN infrastructure might lead to denial of service
            (DoS) attacks within a protected WLAN. A wireless DoS may occur in two ways: at the
            physical layer through RF Jamming, or at the data link layer through packet injection. </description>
           <consistency-rationale> This threat is consistent with <base-name/> </consistency-rationale>
          <objective-refer ref="O.SYSTEM_MONITORING">
            <rationale>The threat T.DISRUPTION is countered by O.SYSTEM_MONITORING as this provides
              for visibility into the network which enables detection of DoS attacks.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The threat T.DISRUPTION is countered by O.WIDS_ANALYZE as this provides for
              detection of potential violations of approved network usage.</rationale>
          </objective-refer>
          <objective-refer ref="O.WIPS_REACT">
            <rationale>The threat T.DISRUPTION is countered by O.WIPS_REACT as this provides
              containment of unauthorized APs and EUDs.</rationale>
          </objective-refer>
        </threat>
      </threats>
    </section>
    <section title="Assumptions" id="assumption">
      <assumptions>
        <assumption name="A.CONNECTIONS">
          <description> It is assumed that the TOE is connected to distinct networks in a manner
             that ensures that the TOE's security policies will be enforced on all applicable network
             traffic flowing among the attached networks. </description>
           <consistency-rationale> This assumption is consistent with <base-name/> </consistency-rationale>
           <objective-refer ref="OE.CONNECTIONS">
             <rationale> The operational environment objective OE.CONNECTIONS is realized through
              A.CONNECTIONS.</rationale>
           </objective-refer>
        </assumption>
        <assumption name="A.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or
            hostile, and administers the WIDS within compliance of the applied enterprise security
            policy. </description>
           <consistency-rationale> This assumption is consistent with <base-name/> </consistency-rationale>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale> The operational environment objective OE.PROPER_ADMIN is realized through
              A.PROPER_ADMIN.</rationale>
          </objective-refer>
        </assumption>
        <assumption name="A.PHYSICAL_PROTECTION"><from base="Network Device"/>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale> Cuase I wanted to show an example.  </rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section title="Organizational Security Policies" id="osp"> An organization deploying the TOE is
      expected to satisfy the organizational security policy listed below in addition to all
      organizational security policies defined by the claimed base PP. <OSPs>
        <OSP name="P.ANALYZE">
          <description>Analytical processes and information to derive conclusions about potential
            intrusions must be applied to WIDS data and appropriate response actions
            taken.</description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
          <objective-refer ref="O.WIDS_ANALYZE">
            <rationale>The organizational security policy P.ANALYZE is facilitated through
              O.WIDS_ANALYZE. </rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
  </sec:Security_Problem_Description>
  <sec:Security_Objectives>
    <sec:Security_Objectives_for_the_TOE>
      <!-- Later: Make sure new SFRs are mapped to SOs -->
      <SOs>
        <SO name="O.SYSTEM_MONITORING">
          <description> To be able to analyze and react to potential network policy violations, the
            WIDS must be able to collect and store essential data elements of network traffic on
            monitored networks.<h:br/>
          </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
	  <addressed-by>FAU_GEN.1/WIDS</addressed-by>
          <rationale>Good reasons</rationale><!-- Mandatory -->
	  <addressed-by>FAU_STG_EXT.1/PCAP</addressed-by>
          <rationale>Good reasons</rationale><!-- Mandatory -->
        </SO>
        <SO name="O.WIDS_ANALYZE">
          <description> The WIDS must be able to analyze collected or observed WLAN activity on
            monitored network to identify potential violations of approved WLAN policies,
            unauthorized connections involving internal WLAN devices, and non-secure communications.
            <h:br/><h:br/>
          </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
          <addressed-by>
	    <!-- Mandatory -->
	    FAU_ARP.1, FAU_ARP_EXT.2, FAU_IDS_EXT.1, FAU_INV_EXT.1, FAU_INV_EXT.2, FAU_INV_EXT.3,
	    FAU_SAA.1, FAU_WID_EXT.1, FAU_WID_EXT.2, FAU_WID_EXT.3, FAU_WID_EXT.4, FAU_WID_EXT.5, FDP_IFC.1,
	    <!-- Optional -->
	    FAU_ANO_EXT.1(OPTIONAL), FAU_INV_EXT.4(OPTIONAL),
	    <!--  <component-refer ref="FAU_INV_EXT.4" iteration="CELL"/>-->
	    FAU_INV_EXT.5(OPTIONAL), FAU_MAC_EXT.1(OPTIONAL), FAU_SIG_EXT.1(OPTIONAL), FAU_WID_EXT.6(OPTIONAL),
	    FAU_WID_EXT.7(OPTIONAL), FAU_WID_EXT.8(OPTIONAL)
	  </addressed-by>
          <rationale>Good reasons</rationale>
        </SO>    
        <SO name="O.WIPS_REACT"><!-- NIAP: WIPS functionality is optional, so technically this is an optional objective -->
          <description> The TOE must be able to react as configured by the administrators to
            isolate/contain WLAN devices that have been determined to violate administrator-defined
            WIPS policies. <h:br/>
          </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
	  <addressed-by>
            FAU_WIP_EXT.1 (OPTIONAL)
	  </addressed-by>
          <rationale>Good reasons</rationale>
        </SO>
        <SO name="O.TOE_ADMINISTRATION">
          <description> To address the threat of unauthorized administrator access that is defined
            in the base PP, Conformant TOEs will provide the functions necessary for an
            administrator to configure the WIDS Capabilities of the TOE. <h:br/>
          </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
	  <addressed-by>
            FMT_SMF.1/WIDS
          </addressed-by>
          <rationale>Good reasons</rationale>
        </SO>
        <SO name="O.INSECURE_OPERATIONS">
          <description> There may be instances where the TOE’s hardware malfunctions or the
            integrity of the TOE’s software is compromised, the latter being due to malicious or
            non-malicious intent. To address the concern of the TOE operating outside of its
            hardware or software specification, the TOE will log or produce an alert upon discovery
            of a problem reported via the self-test mechanism. <h:br/>
          </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
	  <addressed-by>
	    FPT_FLS.1(Optional)
	  </addressed-by>
          <rationale>Good reasons</rationale>
        </SO>
        <SO name="O.TRUSTED_COMMUNICATIONS">
          <description> To further address the threat of untrusted communications channels that is
            defined in the base PP, conformant TOEs will provide trusted communications between
            distributed components if any exist. <h:br/>
          </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
          <addressed-by>
            <!-- Mandatory -->
	    FPT_ITT.1, FTP_ITC.1
            <!-- Optional -->
	  </addressed-by>
          <rationale>Good reasons</rationale>
        </SO>
      </SOs>
    </sec:Security_Objectives_for_the_TOE>
    <section title="Security Objectives for the Operational Environment" id="SecurityObjectivesTOEorEnvironment"> 
      The following security objectives for the operational
      environment assist the TOE in correctly providing its security functionality. These track the
      assumptions about the environment. <SOEs>
        <SOE name="OE.CONNECTIONS">
          <description> TOE administrators will ensure that the TOE is installed in a manner that
            will allow the TOE to effectively enforce its policies on the network traffic of
            monitored networks. </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
        </SOE>
        <SOE name="OE.PROPER_ADMIN">
          <description> The administrator of the WIDS is not careless, willfully negligent or
            hostile, and administers the WIDS within compliance of the applied enterprise security
            policy. </description>
           <consistency-rationale>Just because <base-name/></consistency-rationale>
        </SOE>
      </SOEs>
    </section>
    <section title="Security Objectives Rationale" id="SOR">
      <!-- NOTE: This section should remain empty and is populated from the rationale tags in the previous sections.  -->
    </section>
  </sec:Security_Objectives>
  <sec:Security_Requirements>
    <base-pp version="2.1" name="Network Device" product="Network Device" short="ND" url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=440&amp;id=440" xmlurl="test">
      <modified-sfrs>
        <sec:from_nd_fpt title="Protection of the TSF (FPT)">
          <f-component cc-id="fpt_itt.1" name="Basic Internal TSF Data Transfer Protection"><!-- DONE -->
            <consistency-rationale>Some really good reasons </consistency-rationale>
            <f-element>
              <title>The TSF shall protect TSF data from <h:u>disclosure and <h:b>detect its</h:b> modification</h:u> when it is transmitted between separate parts of the TOE <h:b>through the use of <selectables>
                  <selectable>IPsec</selectable>
                  <selectable>SSH</selectable>
                  <selectable>TLS</selectable>
                  <selectable>TLS/HTTPS</selectable>
                </selectables></h:b>. </title>
              <note role="application">
                FPT_ITT.1 is optional in NDcPP, however, since a WIDS/WIPS TOE is distributed,
                FPT_ITT.1 shall be included in the ST as modified in this PP-Module and is
                applicable to the data transmitted between the sensors and controller.<h:br/><h:br/>
                This requirement ensures all communications between components of a distributed TOE
                is protected through the use of an encrypted communications channel. The data passed
                in this trusted communication channel are encrypted as defined in the protocol
                chosen in the selection. The ST author chooses the mechanisms supported by the TOE,
                and then ensures that the detailed protocol requirements in Appendix B of NDcPP
                corresponding to their selection are included in the ST, if not already present. 
              </note>
              <aactivity>               
                The evaluator shall perform the evaluation activity specified in NDcPP for this SFR.
              <no-tests/>          
              </aactivity>
            </f-element>
          </f-component>
        </sec:from_nd_fpt>
        <sec:ftp title="Trusted Paths/Channels (FTP)">
          <f-component cc-id="ftp_itc.1" name="Inter-TSF trusted channel"><!-- DONE -->
            <consistency-rationale/>
            <f-element>
              <title> The TSF shall <h:b>be capable of using <selectables>
                <selectable>IPsec</selectable>
                <selectable>SSH</selectable>
                <selectable>TLS</selectable>
                <selectable>HTTPS</selectable>
              </selectables> to</h:b> provide a trusted communication channel between itself and
                <h:b>authorized IT entities supporting the following capabilities: audit server, <selectables>
                  <selectable>database server</selectable>
                  <selectable><assignable>other capabilities</assignable></selectable>
                  <selectable>no other capabilities</selectable>
                </selectables></h:b> that is logically distinct from other communication channels
                and provides assured identification of its end points and protection of the channel
                data from <h:b>disclosure and detection of modification of the channel data.</h:b>
              </title>
              
            </f-element>
            <f-element>
              <title>The TSF shall permit <h:b><h:u>the TSF or the authorized IT
                entities</h:u></h:b> to initiate communication via the trusted channel.</title>
            </f-element>
            <f-element>
              <title>
                The TSF shall initiate communication via the trusted channel for <assignable>list of services for which the TSF is able to initiate communications</assignable>.</title>
              <note role="Application">
                <!-- NIAP: Should entire App note from ND be copied? --> 
                The intent of the above requirement is to provide a means by which a cryptographic protocol may be used to
                protect external communications with authorized IT entities that the TOE interacts
                with to perform its functions. The TOE uses at least one of the listed protocols for
                communications with the server that collects the audit information. <h:br/><h:br/>
                
                If the TSF uses a separate database server, the database server selection must
                included in the ST.<h:br/><h:br/> 
                
                If other authorized IT entities are protected, the
                ST author makes the appropriate assignments (for those entities) and selections (for
                the protocols that are used to protect those connections). The ST author selects the
                mechanism or mechanisms supported by the TOE, and then ensures that the detailed
                protocol requirements in Appendix B of NDcPP corresponding to their selection are
                included in the ST. </note>
              <aactivity>
                 The evaluator shall perform the evaluation activity specified in NDcPP for this SFR, with the inclusion of test 4, which is objective in NDcPP. 
                <no-tests/>
              </aactivity>
            </f-element>
          </f-component>
	</sec:ftp>
      </modified-sfrs>
      <additional-sfrs/>
      <con-toe> 
        When this PP-Module extends the Network Device cPP, the TOE type for the overall TOE is still WIDS/WIPS products. </con-toe>
      <con-sec-prob/>
      <con-obj/>
      <con-op-en/>
      <con-mod ref="T.UNAUTHORIZED_ACCESS">HHHHHHHHYYY.</con-mod>
      <con-mod ref="fau_gen.1" iteration="WIDS"> Specific to the ND base. </con-mod>
      <con-mod ref="ftp_itc.1">FTP base reasons</con-mod>
    </base-pp>
    <man-sfrs>
      <sec:man_fau title="Security Audit (FAU)">
        <f-component cc-id="fau_arp.1" name="Security Alarms"> <!-- DONE -->
          <consistency-rationale/>
          <f-element id="fel-arp">
            <title>
              The TSF shall <h:i>display an alert to Authorized Administrator in sufficient detail to include identity of APs and EUDs involved, description of alert and severity level and</h:i>
              <selectables>
                <selectable id="pcap">capture raw frame traffic that triggered the violation</selectable>
                <selectable>no other actions</selectable>
              </selectables> upon detection of a potential security violation.</title>
            <note role="application"> 
              If "capture raw frame traffic that triggers the violation" is
              selected then FAU_STG_EXT.1/PCAP shall be included in the ST.</note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes where to find the WIDS alerts
                on the Administrator console/interface.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall use the operational guidance for instructions on where
                the alerts generated are displayed within the WIDS interface. If the objective
                requirement to capture the raw frame that triggered an alert is selected, the
                evaluator must also test for corresponding selection-based requirements. The
                evaluator shall use the operational guidance to configure the traffic capture
                capabilities.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall perform a series of events or generate traffic that
                    would successfully trigger an alert. The evaluator should verify and record
                    whether the TOE generated the alert. The evaluator should also record the events
                    or traffic that was generated and what alert was attempted to be triggered and
                    record the details provided by the TOE in the alert.
                  </test>
                  <test><h:i>[conditional]</h:i> If capturing of raw frames was selected, verify that the packet capture was
                    triggered and stored as appropriate.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Security Alarm Filtering" fam-id="FAU_ARP_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_arp_ext.2" name="Security Alarm Filtering"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall provide the ability to apply <assignable>methods of
              selection</assignable> to selectively exclude alerts from being generated. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the ability of the TOE to
                transmit WIDS alerts.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance includes
                instructions on enabling and disabling alerts.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>The evaluator shall use the operational guidance to enable/disable
                        detection of available detection capabilities through the WIDS administrator
                        interface. The evaluator shall then generate traffic that would successfully
                        trigger the alert. The evaluator should verify that the TOE generated the
                        alert. The evaluator shall record the attack/intrusion that was generated
                        and indicate which alert was triggered as well as the details that were
                        provided by the WIDS about the alert.</h:li>
                      <h:li>The evaluator shall disable the alert. The evaluator shall then generate
                        events as in previous test that should successfully trigger the alert. The
                        evaluator should check if the TOE generated an alert for the attack and
                        record the findings. </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <f-component cc-id="fau_gen.1" name="Audit Data Generation" iteration="WIDS"><!-- DONE for now. FAU_SAA is how to look at audit records and determine that something bad may have happened, so should all of the "events" in FAU_SAA be audit records? -->
          <consistency-rationale>Wids module rationale/</consistency-rationale>
          <f-element> <!-- Changed: Moved the actual audit events from objective FAU_GEN and put here. -->
            <title> The TSF shall be able to generate an audit record of the following auditable
              events: <h:ol type="a">
                <h:li>Start-up and shutdown of the audit functions;</h:li>
                <h:li>All auditable events for the [not specified] level of audit;</h:li>
                <h:li><h:i>[Auditable events listed in <xref to="auditWids"/>;</h:i></h:li>
                <h:li><h:i>Failure of wireless sensor communication].</h:i></h:li>
              </h:ol>
              <h:table>
                <h:thead>
                  <h:tr><h:td colspan="99"> <ctr id="auditWids" ctr-type="Table">: Auditable Events</ctr> </h:td></h:tr>
                  <h:tr><h:th>Requirement</h:th><h:th>Auditable Events</h:th><h:th>Additional Audit Record Contents</h:th></h:tr>
                </h:thead>
                <h:tbody>
                <h:tr><h:td>FAU_ANO_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_ARP.1</h:td><h:td>Actions taken due to potential security violations</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_ARP_EXT.2</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_GEN.1/WIDS</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_IDS_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.1</h:td><h:td>Presence of whitelisted device</h:td><h:td>Type of device (AP or EUD), MAC Address</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.2</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.3</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_INV_EXT.4</h:td><h:td>Location of AP or EUD</h:td><h:td>MAC Address, device type, classification of device, sensor(s) that detected device, signal strength as received by detecting sensor(s), proximity to detecting sensor(s)</h:td></h:tr>
                <!--  <h:tr><h:td>FAU_INV_EXT.4/CELL</h:td><h:td>Location of AP or EUD</h:td><h:td>MAC Address, device type, classification of device, sensor(s) that detected device, signal strength as received by detecting sensor(s), proximity to detecting sensor(s)</h:td></h:tr>-->
                <h:tr><h:td>FAU_INV_EXT.5</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_MAC_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_SAA.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_SIG_EXT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_STG_EXT.1/PCAP</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td rowspan="2">FAU_WID_EXT.1</h:td><h:td>Detection of rogue AP or EUD</h:td><h:td>None</h:td></h:tr>
                  <h:tr><h:td>Detection of unauthorized SSID</h:td><h:td>None</h:td></h:tr> 
                <h:tr><h:td>FAU_WID_EXT.2</h:td><h:td>Sensor wireless transmissions
                  capabilities.</h:td><h:td>Wireless transmission cappabilities are turned
                    on.</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.3</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.4</h:td><h:td>Use of an unauthorized authentication schemes</h:td><h:td>MAC Address, device type, classification of the device, authentication method used</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.5</h:td><h:td>Use of an unauthorized encryption schemes</h:td><h:td>MAC Address, device type, classification of the device, encryption method used</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.6</h:td><h:td>Detection of network devices operating in selected RF bands</h:td><h:td>Frequency band, channel used within frequency band, identification information (MAC address if applicable or other similar unique ID), device technology (i.e., cellular), sensor(s) that detected devices</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.7</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WID_EXT.8</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FAU_WIP_EXT.1</h:td><h:td>Isolation of AP or EUD</h:td><h:td>Description of violation, type of containment used, was
                    containment triggered manually or automatically, sensor performing the
                    containment (if wireless), details about the device (s) being contained
                    (classification, device type, MAC address).</h:td></h:tr>
                <h:tr><h:td>FDP_IFC.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FMT_SMF.1/WIDS</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FPT_FLS.1</h:td><h:td>Information about failure.</h:td><h:td>Indication
                  that there was a failure, type of failure, device that failed, and time of
                  failure.</h:td></h:tr>
                <h:tr><h:td>FPT_ITT.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                <h:tr><h:td>FTP_ITC.1</h:td><h:td>None</h:td><h:td>None</h:td></h:tr>
                </h:tbody>
              </h:table>
            </title>
            <note role="application"> 
              
              The auditable events defined in <xref to="auditWids"/>
              are for the SFRs that are explicitly defined in this PP-Module and are intended to
              extend FAU_GEN.1 in the Base-PP. The events in the <xref to="auditWids"/> should
              be combined with those of the ND cPP in the context of a conforming Security
              Target.<h:br/><h:br/> 
            </note>
          </f-element>
          <f-element>
            <title> The TSF shall record within each audit record at least the following information: <h:ol type="a">
              <h:li>Date and time of the event, type of event, and subject identity (if
                applicable);</h:li>
              <h:li>For each audit event type, based on the auditable event definitions of the
                functional components included in the PP/ST, [<h:i>auditable events listed in
                  <xref to="auditWids"/></h:i>]. </h:li>
            </h:ol>
            </title>
            <note role="application">
              The subject identity in this case is the whitelisted inventory item. </note>
            <aactivity>
              <TSS> 
                There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall test the TOE’s ability to correctly generate audit records
                by having the TOE generate audit records in accordance with the assurance activities
                associated with the functional requirements in this PP-Module. When verifying the
                test results, the evaluator shall ensure the audit records generated during testing
                match the format specified in the administrative guide, and that the fields in each
                audit record have the proper entries. <h:br/><h:br/> 
                Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly.
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Reporting Methods" fam-id="FAU_GEN_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component name="Intrusion Detection System – Reporting Methods" cc-id="fau_gen_ext.1"> <!-- DONE -->
          <!-- New Component --> <!-- Import/export data post processing from WIDS controller. Import/export configuration - management of sensor -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>                
          <f-element>
            <title> 
              The TSF shall provide <selectables linebreak="yes">
                <selectable>Syslog using <selectables>
                  <selectable>defined API</selectable>
                  <selectable>Syslog</selectable>
                  <selectable><assignable>other detection method</assignable></selectable>
                </selectables></selectable>
                <selectable>SNMP trap reporting using <selectables>
                  <selectable>defined API</selectable>
                  <selectable>Simple Network Management Protocol (SNMP)</selectable>
                  <selectable><assignable>other detection method</assignable></selectable>
                </selectables></selectable>
              </selectables>. </title>
            <note role="application"> Syslog and/or SNMP trap reporting can be used. At least one reporting method must be selected.
              <!-- Later_TODO: If SNMP is selected - then need to specify version number -->
            </note>
          </f-element>        
          <f-element>
            <title> The TSF shall provide the ability to import data from the system: <selectables>
              <selectable>custom API</selectable>
              <selectable>Syslog</selectable>
              <selectable>common log format</selectable>
              <selectable>CSV</selectable>
              <selectable><assignable> vendor detection method (e.g. Splunk)</assignable></selectable>
            </selectables>
            </title>
            <note role="application"> The system shall provide the ability to interact with an
              extensible interface to a third party wireless monitoring system
              for the purposes of importing data from the wireless system.</note>
            <aactivity>
              <TSS>             
                The evaluator shall verify that the TSS includes which method the TOE utilizes. 
              </TSS>
              <Guidance> 
                
              </Guidance>
              <Tests>
                Depending on the detection technique used by the TOE, the
                evaluator shall confirm and note the existence of the capability, and test for the
                appropriate selection-based requirements.
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events
                        generated by the AP.</step>
                      <step>Confirm that the TSF can utilize SNMP and Syslog reporting mechanisms.</step>
                       
                      <step>Verify that the TSF can import and export observable event
                        data in any of the following formats:</step>
                      <h:ul>
                        <h:li>comma separated values (CSV)</h:li>
                        <h:li>common log format (CLF)</h:li>
                        <h:li>JavaScript Object Notation (JSON)</h:li>
                        <h:li>syslog</h:li>
                      </h:ul>
                    </steplist>
                  </test>
                </testlist>              
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Intrusion Detection Methods" fam-id="FAU_IDS_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_ids_ext.1" name="Intrusion Detection System – Intrusion Detection Methods"><!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element id="fel-ids-meth">
            <title> 
              The TSF shall provide the following methods of intrusion detection <selectables>
              <selectable id="anoBased">anomaly-based</selectable>
              <selectable id="sigBased">signature-based</selectable>
              <selectable>behavior-based</selectable>
              <selectable><assignable>other detection method</assignable></selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
              <title> 
                The TSF shall provide the following methods of intrusion detection
                   <assignable>detection methods</assignable>.
              </title>
            </ext-comp-def-title>
            <note role="application"> 
              At least one detection method must be selected. If multiple detection methods are supported, each method supported shall be selected. <h:br/><h:br/>  
              If anomaly-based detection is selected, then FAU_ANO_EXT.1 shall be included in the ST. If signature-based detection is selected, then FAU_SIG_EXT.1 shall be included in the ST.<h:br/><h:br/> 
            </note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes which intrusion detection method(s) the TOE utilizes. If multiple methods are selected, the evaluator shall confirm that the TSS describes how the different methods are incorporated.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall verify that the operational guidance provides instructions on how to configure the TOE in order for it to detect such intrusions.<h:br/><h:br/>
              </Guidance>
              <Tests> 
                Depending on the detection technique used by the TOE, the evaluator shall confirm and note the existence of the capability and test for the appropriate selection-based requirements. 
              </Tests>
            </aactivity>
          </f-element>

        </f-component>
               
        <ext-comp-def title="Environmental Inventory" fam-id="FAU_INV_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.1" name="Environmental Inventory"> <!-- DONE -->
          <!-- Changed: Moved admin action of actually creating inventory to FMT_SMF.1.1 made 1.1 more about comparing AP/EUD against inventory to determine if authorized. Removed "current information" from these 1.2 and 1.3, since they just pointed to 2.3 as this is information that has to be collected so ultimately just a duplicate -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element> 
            <title> The TSF shall determine if a given AP or EUD is authorized based on MAC addresses. </title>          
          </f-element>
          <f-element>
            <title> The TSF shall detect the presence of whitelisted EUDs and APs in the Operational Environment. </title>
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect the presence of non-whitelisted EUDs and APs in the Operational Environment. 
            </title>
            <note role="application"> 
              The inventory of authorized APs and EUDs is defined by FMT_SMF.1. <h:br/><h:br/>
              This inventory is used as a whitelist to indicate to the WIDS which APs and EUDs are legitimate members of the wireless network. The terminology used to describe an inventoried or whitelisted device may vary by vendor product. This PP-Module utilizes whitelisted to describe APs and EUDs that are part of the inventory and non-whitelisted to describe APs and EUDs that are not part of the inventory.
            </note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS describes how the presence of authorized EUDs and APs is presented by the TOE. The evaluator shall verify that the TSS includes where in the WIDS interface the list of detected APs and EUDs is
                displayed.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall verify that the operational
                guidance provides instructions on how to view authorized and unathorized APs and EUDs that are
                within range of the TOE sensors.<h:br/><h:br/>
              </Guidance>
              <Tests> 
                <testlist>
                  <test>
                    <steplist>
                      <step>Per guidance in FMT_SMF.1, add MAC Addresses for an AP and EUD to the whitelist.</step>
                      <step>Deploy the AP and EUD that were added to whitelist within the range of the TOE's sensors.</step>                 
                      <step>Verify that the devices are classified as authorized.</step>
                      <step>Remove the EUD from the whitelist.</step>
                      <step>Verify that the EUD is classified as unauthorized.</step>
                      <step>Remove the AP from the whitelist.</step>
                      <step>Verify that the AP is classified as unauthorized.</step>
                    </steplist>
                  </test>             
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and EUD, and connect the EUD to the AP.</step>
                      <step>Verify that the list of detected APs and EUDs contains the whitelisted AP
                    and EUD that were just deployed. </step>
                      <step>If the AP and EUD are detected verify that they are classified as
                    whitelisted devices.</step>
                    </steplist>
                   </test>                
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP and EUD and connect the EUD to the AP.</step>
                      <step>Verify that the list of detected APs and EUDs contains the non-whitelisted
                    AP and EUD that were just deployed.</step>
                      <step>If the AP and EUD are detected verify that they are not classified as
                    whitelisted devices.</step>
                    </steplist></test>        
                </testlist>
              </Tests>             
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Characteristics of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.2" name="Characteristics of Environmental Objects"> <!-- DONE -->    
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>   
          <f-element> <!-- Changed: Broke (what was) 2.3 (now 2.1) up into (now) 2.1,2.2 and 2.3. As it was written it was too wordy -->
            <title> 
              The TSF shall detect the <h:ul>
              <h:li>current RF band</h:li>
              <h:li>current channel</h:li>
              <h:li>MAC Address</h:li>
              <h:li>classification of APs and EUDs</h:li>
              <h:li><selectables>
                <selectable><assignable>other details</assignable></selectable>
                <selectable>no other details</selectable>
              </selectables></h:li>
              </h:ul>of all APs and EUDs within range of the TOE’s wireless sensors.
            </title>
          </f-element>
          <f-element>
            <title>
              The TSF shall detect the follow additional details for APs:<h:ul>
              <h:li>encryption</h:li>
              <h:li>number of connected EUDs.</h:li>
            </h:ul> 
            </title>
            <note role="Application">
              For detection of encryption type, the TSF should be able to
              differentiate between the different WLAN encryption methods and when no encryption is
              in use. </note>
          </f-element>
          <f-element>
            <title>
              The TSF shall detect the follow additional details for EUDs:<h:ul>
              <h:li>SSID and BSSID of AP it is connected to.</h:li>
            </h:ul>
            </title>           
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS explains the capability of detecting the
                current RF band, current channel, MAC Address, classification of APs and EUDs within
                the TOE’s wireless range.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall review the operational guidance in order to verify that
                there are instructions that show how to locate the device inventory mentioned
                above.<h:br/><h:br/>
              </Guidance>
              <Tests> 
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP, non-whitelisted AP and two whitelisted
                        EUDs.</step>
                      <step>Connect one whitelisted EUD to the whitelisted AP and one to the
                        non-whitelisted AP.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that current RF band, current channel, MAC Address,
                        classification of device, are part of the information presented on the WIDS
                        user interface for all the APs and EUDs detected. For APs verify that
                        encryption, number of connected EUDs is presented. For EUDs verify that the
                        SSID and BSSID of AP it is connected is presented.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Behavior of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.3" name="Behavior of Environmental Objects"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> 
              The TSF shall detect when inventoried EUDs exhibit the following behavior: <h:ul>
                <h:li>An EUD establishes a peer-to-peer connection with any other EUD,</h:li></h:ul>
              <selectables linebreak="yes">
                <selectable>An EUD bridges two network interfaces</selectable>
                <selectable>An EUD uses internet connection sharing</selectable>
                <selectable><assignable>other connection types</assignable></selectable>
                <selectable>no other connections types</selectable>
              </selectables>. 
            </title>
            <note role="Application">For this requirement, it is acceptable for the WIDS to use a
              generic terms for bridges or peer-to-peer connections when generating an alert for the
              detection of different types of bridges or peer-to-peer connections. The type of
              connection does not have to be specific. </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the ability of the TOE to
                detect the network behavior described by the SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance to verify that it
                provides instructions on how alerts are presented to the administrator as well as
                information regarding the format of each alert.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    Create the following connections between two whitelisted EUDs. 
                    <h:ul>
                      <h:li>Windows Ad Hoc Connection</h:li>
                      <h:li>Mac OS Ad Hoc</h:li>
                      <h:li>Linux Ad Hoc</h:li>
                      <h:li>Wi-Fi Direct</h:li>
                    </h:ul>
                  </test>
                  <test> Create the following connections between one whitelisted EUD and a
                    non-whitelisted EUD <h:ul>
                      <h:li>Windows Ad Hoc Connection</h:li>
                      <h:li>Mac OS Ad Hoc</h:li>
                      <h:li>Linux Ad Hoc</h:li>
                      <h:li>Wi-Fi Direct</h:li>
                    </h:ul>
                  </test>
                  <test>(optional) Bridge two network interfaces on a whitelisted EUD (one must be
                    the wireless card listed as whitelisted).</test>
                  <test>
                    <h:ul>
                      <h:li>Create a Windows Hosted Network with a whitelisted EUD. </h:li>
                      <h:li>Connect a different whitelisted EUD to the network.</h:li>
                    </h:ul>
                  </test>
                </testlist> Verify that alerts were generated by each of the connections in each
                test. Provide a description of the alert. </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Location of Environmental Objects" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.4" name="Location of Environmental Objects"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element> <!-- Changed: Moved 2.1 and 2.2 to 4.1 and 4.2 so that all location SFRs were in same component -->
            <title> 
              The TSF shall detect information on the current physical location of EUDs and APs within range of the TOE’s wireless sensors. </title>
            <note role="application"> 
              This SFR only checks for the ability of the WIDS to track the
              location of APs and EUDs either by placing them on a map or providing the distance of
              the AP or EUD from the sensor but does not mandate a certain degree of accuracy.
            </note>
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect received signal strength and <selectables>
                <selectable>RF power levels above a predetermined threshold</selectable>
                <selectable>no other characteristics</selectable>
              </selectables> of hardware operating within range of the TOE’s wireless sensors. </title>
          </f-element>
          <f-element>
            <title> The TSF shall detect the physical location of APs and EUDs to within <assignable>value equal or less than 15</assignable> feet of their actual location.</title>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes information on location
                tracking, optimal number of sensors and sensor placement to meet the required level
                of accuracy.<h:br/><h:br/>
                The evaluator shall verify that the TSS contains information regarding the TSF’s
                ability to record signal strength of hardware operating within range of its
                sensors.<h:br/><h:br/>
                
              </TSS>
              <Guidance> 
                The evaluator shall review the operational guidance for instructions on how
                to configure location tracking and where in the TSF administrator interface the
                location of APs and EUDs can be viewed.<h:br/><h:br/>
                If the option for detection of RF power levels above a predetermined
                threshold is selected, the evaluator shall use the operational guidance to set or
                check what the threshold is in a given test. The evaluator should also verify that
                the operational guidance provides instruction on how to configure the TOE to
                generate an alert when the threshold is exceeded.<h:br/><h:br/>
                The evaluator shall review the operational guidance for instructions on how
                to configure location tracking, how to load a location map (if applicable), and
                where in the TSF administrator interface the location of APs and EUDs can be
                viewed.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Verify that TSF is able to provide location information on the
                        AP.</step>
                      <step>Verify that the location presented by the TSF appears within the range
                        of the sensors.</step>
                    </steplist>
                  </test>                 
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that the current received signal strength is part of the
                        information presented on the WIDS user interface about the APs and
                        EUDs.</step>
                    </steplist>
                  </test>            
                  
                  <test>
                    <steplist>
                      <step>Deploy an AP within range of the sensors.</step>
                      <step>Verify the TS provides location tracking information about the
                        AP.</step>
                      <step>Verify the AP location presented is within 15 feet actual
                        location.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        
        <f-component cc-id="fau_saa.1" name="Potential Violation Analysis"> <!-- NIAP: Is this expected format? Meaning does each rule have to be tied to a SFR or can it just be a list of rules? Probably have other rules to add - NULL SSID -->
          <consistency-rationale/>
          <!-- The TSF shall be able to apply a set of rules in monitoring the audited events and based upon these rules indicate a potential violation of the
enforcement of the SFRs.  -->
          <!-- So since this is really about detecting an issue in the audit events then should all of these be audited? 1.1 should be where the table is applied -->
          <f-element>
            <title>The TSF shall be able to apply a set of rules for monitoring the <h:b>wireless traffic</h:b> and based upon these rules indicate a potential <h:b>malicious action</h:b>.</title>
          </f-element>
          <f-element>
            <title>The TSF shall enforce the following rules for monitoring wireless traffic: <h:ol type="a">
              <h:li>Accumulation or combination of <assignable>subset of defined auditable events</assignable> known to indicate a potential security violation; </h:li>
              <h:li><h:i>[other potential security violations as defined by <xref to="SecViolations"/>]</h:i>.</h:li>
            </h:ol>
              <h:table>
                <h:tr class="header">
                 <!--   <h:td>SFR</h:td>-->
                  <h:td>Potential Security Violation</h:td>
                  <h:td>Additional Information</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_INV_EXT.3</h:td>-->
                  <h:td>Detection of authorized EUD establishing peer-to-peer connection with any
                    other EUD.</h:td>
                  <h:td>Description of behavior detected (i.e.,
                    bridge, ICS connection), MAC address of whitelisted device, MAC address of the
                    device that the whitelisted device made a connection with, connection start and
                    end.</h:td>
                </h:tr>
                
                <h:tr>
                  <!--<h:td>FAU_INV_EXT.3</h:td>-->
                  <h:td>Detection of EUD bridging two network interfaces.</h:td>
                  <h:td>Description of behavior detected (i.e.,
                    bridge, ICS connection), MAC address of whitelisted device, MAC address of the
                    device that the whitelisted device made a connection with, connection start and
                    end.</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_INV_EXT.3</h:td>-->
                  <h:td>Detection of packet flooding/DoS/DDoS.</h:td>
                  <h:td>Description of behavior detected (i.e.,
                    bridge, ICS connection), MAC address of whitelisted device, MAC address of the
                    device that the whitelisted device made a connection with, connection start and
                    end.</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_INV_EXT.3</h:td>-->
                  <h:td>Detection of ICS connection.</h:td>
                  <h:td>Description of behavior detected (i.e.,
                    bridge, ICS connection), MAC address of whitelisted device, MAC address of the
                    device that the whitelisted device made a connection with, connection start and
                    end.</h:td>
                </h:tr>
                <h:tr>
                  <!--  <h:td>FAU_INV_EXT.5</h:td>-->
                  <h:td>Detection of rogue device.</h:td>
                  <h:td>Description of alert, type of device (AP
                    or EUD), MAC Address, associations made between authorized devices (which APs
                    are EUDs connected to), channel detected on, RF Band detected on, encryption
                    type used by rogue, IEEE 802.11 standard used (a, b, g, n, ac), SSID (if
                    AP).</h:td></h:tr>
                <h:tr>
                  <!--  <h:td>FAU_MAC_EXT.1.1</h:td>-->
                  <h:td>Detection of mac spoofing.</h:td>
                  <h:td>Description of alert, type of device (AP or EUD), MAC Address, associations
                    made between authorized devices (which APs are EUDs connected to), channel
                    detected on, RF Band detected on, encryption type used by rogue, IEEE 802.11
                    standard used (a, b, g, n, ac), SSID (if AP), location as labeled by administrator,.</h:td>
                </h:tr>
               
                <h:tr>
                  <!--  <h:td>FAU_SIG_EXT.1</h:td>-->
                <h:td>Alert generated by violaton of user defined signature.</h:td>
                <h:td>Name of alert being triggered (as provided when creating the signature), description of alert (as provided when
                    creating the signature), MAC address of devices involved.</h:td>
                    </h:tr>
                
                
                
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.1</h:td>-->
                  <h:td>Detection of rogue AP.</h:td>
                  <h:td>Identity information of the devices involved.</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.1</h:td>-->
                  <h:td>Detection of malicious EUD.</h:td>
                  <h:td>Identity information of the devices involved.</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.2</h:td>-->
                  <h:td>Detection of traffic with excessive transmit power level.</h:td>
                  <h:td>Identity information of the devices involved.</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.2</h:td>-->
                  <h:td>Detection of active probing.</h:td>
                  <h:td>Identity information of the devices involved.</h:td>
                </h:tr>
                <h:tr>
                  <!-- <h:td>FAU_WID_EXT.2</h:td>-->
                  <h:td>Detection of MAC spoofing.</h:td>
                  <h:td>Identity information of the devices involved.</h:td>
                </h:tr>
                <!-- Later: Need to fix -->
                <!--  <h:tr><h:td>FAU_WID_EXT.2.4</h:td>
                  <h:td>Unauthorized activity</h:td>
                  <h:td>description of violation (i.e. whitelisted EUD connected to
                    unauthorized SSID), identity information of the devices involved.</h:td></h:tr>-->
                <h:tr>
                  <!-- <h:td>FAU_WID_EXT.3</h:td>-->
                  <h:td>Detection of RF-based denial of service.</h:td>
                  <h:td>MAC Address, device type, classification AP or EUD
                    attacked<!--  DoS details (RF or injection based), for injection-based, indicate
                    type (i.e., deauth flood)-->. </h:td>
                </h:tr>
                <h:tr>
                  <!-- <h:td>FAU_WID_EXT.3</h:td>-->
                  <h:td>Detection of deauthentication flooding.</h:td>
                  <h:td>MAC Address, device type, and classification AP or EUD
                    attacked<!--  DoS details (RF or injection based), for injection-based, indicate
                    type (i.e., deauth flood)-->. </h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.3</h:td>-->
                  <h:td>Detection of disassociation flooding.</h:td>
                  <h:td>MAC Address, device type, and classification AP or EUD
                    attacked<!--  DoS details (RF or injection based), for injection-based, indicate
                    type (i.e., deauth flood)-->. </h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.3</h:td>-->
                  <h:td>Detection of request-to-send/clear-to-send abuse.</h:td>
                  <h:td>MAC Address, device type, and classification AP or EUD
                    attacked<!--  DoS details (RF or injection based), for injection-based, indicate
                    type (i.e., deauth flood)-->. </h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.4</h:td>-->
                  <h:td>Detection of unauthorized authentication scheme use.</h:td>
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.5</h:td>-->
                  <h:td>Detection of unauthorized encryption scheme use.</h:td>
                  
                </h:tr>
                <h:tr>
                  <!--<h:td>FAU_WID_EXT.5</h:td>-->
                  <h:td>Detection of unencrypted traffic.</h:td>
                </h:tr>
              </h:table>
              <ctr id="SecViolations" ctr-type="Table">: Potential Security Violations</ctr>
            </title>
            <aactivity>
              <TSS> 
                There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> 
                There are no tests for this SFR. Testing of monotoring capabities and detection of potential malicious events is tested through the ability to detect intrusions in other SFRs. </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Malicious Environmental Objects" fam-id="FAU_WID_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.1" name="Wireless Intrusion Detection – Malicious Environmental Objects"> <!-- DONE for now -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall apply <selectables><selectable>configurable</selectable><selectable>automatic</selectable></selectables> classification rules to detect rogue APs. </title> 
            <note role="application">
              If "configurable" is selected then, "Define classification rules to detect rogue APs" shall be selected in FMT_SMF.1    
            </note>
          </f-element>
          <f-element>
            <title> The TSF shall distinguish between benign and malicious APs and EUDs based on automatic detection metrics. </title>
            
          </f-element>
          <f-element> <!-- Changed: Moved ability to configure authorized SSIDs to FMT_SMF and changed this element to be more around determining if a monitored SSID is authorized. Moved element to component 1-->
            <title> 
              The TSF shall provide the ability to determine if a given SSID is authorized. </title>
            <note role="application"> 
              FMT_SMF.1 defines the subset of authorized SSID(s).        
            </note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS describes how the TOE can detect rogue APs and whether the classification rules are configurable. The evaluator shall verify that the TSS includes how the TOE determines if a given SSID is authorized.
                <h:br/><h:br/>
              </TSS>
              <Guidance> 
                If classification rules for rogue APs are configurable, the evaluator shall verify that the operational guidance contains instructions for configuring the classification rules. The evaluator shall verify that the operational guidance provides instructions on how to configure SSIDs as authorized.<h:br/><h:br/>
              </Guidance>
              <Tests>             
                <testlist>
                  <test>
                    <steplist>
                      <step>The evaluator shall configure the AP classifcation rules, if supported.</step>
                      <step>Deploy an AP that would be detected as rogue by the classification rules.</step>
                      <step>Verify that the AP gets correctly classified.</step>
                    </steplist>                
                  </test>
                  <test>
                    For each test below the evaluator shall verify that the TOE detects and appropriately classifies the APs and EUDs.
                    <testlist> <!-- Justin_later: We need to state the appropriate classification for each of the items listed. Also "attack" is probably too vague. -->
                      <test>Deploy a non-whitelisted AP in the area of the WIDS sensor, but take no action against the network.</test>
                      <test>Deploy a non-whitelisted AP in the area of the WIDS sensor and connect it to the internal wired infrastructure (optional for overlay WIDS).</test>
                      <test>Connect a whitelisted EUD to a non-whitelisted AP.</test>
                      <test>Connect a non-whitelisted EUD to a whitelisted AP.</test>
                      <test>Launch an attack against authorized AP with an unauthorized EUD.</test>
                    </testlist>
                  </test>
                  
                  The evaluator shall configure the TSF with a set of authorized SSIDs and
                  perform the following tests:
                  
                  <test> 
                      <h:b>Unauthorized SSID, Unauthorized Connections - 2.4 GHz band</h:b>
                      <steplist>
                        <step>Configure a whitelisted AP to operate on a set channel on the 2.4 GHz
                          band with an authorized SSID.</step>
                        <step>Connect a non-whitelisted EUD to AP.</step>
                        <step>Verify that the TSF detects the non-whitelisted EUD connecting to the
                          whitelisted AP.</step>
                        <step>Change the AP's SSID to one not on the authorized list.</step>
                        <step>Connect a whitelisted EUD to AP.</step>
                        <step>Verify that the TSF detects the whitelisted AP using unauthorized SSID
                          and the EUD associating to an unauthorized SSID.</step>
                      </steplist>
                    </test>
                    
                    <test>
                      <h:b>Unauthorized SSID, Unauthorized Connections - 5 GHz band</h:b>
                      <steplist>
                        <step>Configure a whitelisted AP to operate on a set channel on the 5 GHz band
                          with an authorized SSID. </step>
                        <step>Connect a non-whitelisted EUD to AP.</step>
                        <step>Verify that the TSF detects the non-whitelisted EUD connecting to the
                          whitelisted AP.</step>
                        <step>hange the AP's SSID to one not on the authorized list.</step>
                        <step>Connect a whitelisted EUD to AP.</step>
                        <step>Verify that the TSF detects the whitelisted AP using unauthorized SSID
                          and the EUD associating to an unauthorized SSID.</step>
                      </steplist>
                    </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Passive Information Flow Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.2" name="Wireless Intrusion Detection – Passive Information Flow Monitoring"><!-- DONE for now. These elements should be broken up into different components. -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element> <!-- Changed: Added [selection: simultaneously, nonsimultaneously] monitor, to clean up the wording -->
            <title> 
              The TSF shall <selectables><selectable>simultaneously</selectable><selectable>nonsimultaneously</selectable></selectables> monitor and analyze network traffic matching the 802.11 monitoring SFP for all channels in the following RF frequencies: <h:ul>
              <h:li>2.4 GHz</h:li>
              <h:li>4.9/5.0 GHz</h:li>
            </h:ul>
              <selectables linebreak="yes">
                <selectable>channels outside regulatory domain</selectable>
                <selectable>non-standard channel frequencies</selectable>
                <selectable>no other domains</selectable>
              </selectables>.
            </title>
            <note role="Application"> 
              If "nonsimultaneously" is selected, then "Define the amount of time sensor monitors a specific channel" shall be selected in FMT_SMF.1. <h:br/><h:br/> The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe what the policy does. The "802.11 monitoring SFP" is established in FDP_IFC.1> and defined through the FAU_WID_EXT SFRs. A vendor does not have to formally define this policy, it only needs to comply with the SFRs.</note>        
          </f-element>
          <f-element> <!-- Later_todo: Fix this wording. I do not think that the 802.11 monitoring SPF needs to be included. This is really just an on/off button for sensor transmit. -->
            <title> 
              The TSF shall provide wireless sensors to detect network traffic matching the 802.11 monitoring SFP that <selectables>
                <selectable>can be configured to prevent transmission of data</selectable>
                <selectable>does not transmit data</selectable>
              </selectables>. 
            </title>
            <note role="application"> 
              If "can be configured to prevent transmission of data" is selected then "Enable/Disable transmission of data by wireless sensor" shall be selected in FMT_SMF.1. <h:br/><h:br/>
              The intent of this SFR is to employ WIDS sensors that can have
              all wireless transmission capabilities disabled for instances where a site wishes to
              implement a no wireless policy. <h:br/> The "802.11 monitoring SFP" is a security
              function policy and the SFRs that reference this policy describe what the policy does.
              The "802.11 monitoring SFP" is established in FDP_IFC.1> and
              defined through the FAU_WID_EXT SFRs. A vendor does not have to
              formally define this policy, it only needs to comply with the SFRs. </note>
          </f-element>      
          <f-element> <!-- Changed: Added new element (NULL SSID) -->
            <title> 
              The TSF shall detect the presence of the following unauthorized connections and unauthorized network traffic:<h:ul>
                <h:li>unauthorized APs broadcasting authorized SSIDs</h:li>
                <h:li>APs and EUDs spoofing the MAC address of whitelisted APs and EUDs</h:li>
                <h:li>authorized EUDs associating to unauthorized SSIDs</h:li>
                <h:li>unauthorized EUDs associating to authorized APs</h:li>
                <h:li>unauthorized point to point wireless bridges by whitelisted APs</h:li>
                <h:li>active probing</h:li>
                <h:li>NULL SSID associations</h:li> <!--Todo: Add to FAU_SAA.1.2-->
                <h:li>
                  <selectables>
                    <selectable>illegal state transitions</selectable>
                    <selectable>protocol violations for <selectables>
                      <selectable>802.11</selectable>
                      <selectable>802.1X</selectable>                    
                    </selectables>
                    </selectable>
                    <selectable>no other</selectable>
                  </selectables>.</h:li>
              </h:ul>
            </title>
            <note role="application"> 
              “Authorized” EUDs/APs are those that are assigned to the
              whitelist as defined by FMT_SMF.1. <h:br/><h:br/>
            
            The 802.11 standard allows APs to beacon with the SSID field
            set to null. This is referred to as a hidden or cloaked SSID. The client seeking to
            associate with an AP using a hidden SSID must first send out a Probe Request that
            contains the SSID of that network, then the AP will return with a Probe Request of its
            own. The TSF needs to be able to detect if an AP is allowing clients to associate
            without providing the valid SSID of the AP. 
            </note>    
          </f-element>
          <f-element><!-- NEW SFR -->
            <title> 
              The TSF shall perform stateful frame inspection and log attacks spanning multiple frames. </title>
            <note role="application"> 
              Attackers possess the capability to distribute an attack
              across multiple frames in an attempt to avoid traditional detection measures that
              solely focus on packet headers. Stateful frame inspection will allow for the
              identification of obfuscation techniques centered around spreading an attack across
              multiple frames.</note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes which channels the TOE can detect and monitor. Additionally, the TSS shall include whether the TOE simultaneously or nonsimultaneously monitors network traffic across these channels. The evaluator shall verify that the TSS includes information on if the sensors are completely passive, by default, or if the sensors ability to transmit data is configurable. The evaluator shall verify that the TSS describes the methods that the TOE uses to detect the presence of unauthorized connections and unauthorized network traffic.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall review the operational guidance for how to configure the TOE to monitor the channels as selected in the SFR. If the sensor ability to transmits data is configurable, the evaluator shall review the operational guidance for how to disable wireless transmissions from the sensor. The TOE shall have the ability to perform stateful frame inspection and log
                attacks spanning multiple frames. The evaluator shall verify that the operational
                guidance provides instructions on how to specify and confirm that stateful frame
                capture and inspection is being performed.<h:br/><h:br/>
              </Guidance>
              <Tests> 
                <h:b>Channels Monitored</h:b>
                <testlist>
                  <test> Channels on On 5GHz band 
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy an AP on at least 2 different channels within the regulatory domain on 5GHz band.</step>
                      <step>Deploy an AP on at least 2 different channels outside the regulatory domain on 5GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Channels on 2.4GHz band 
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels within the regulatory domain on 2.4GHz band.</step>
                      <step>Deploy AP on at least 2 different channels outside the regulatory domain on 2.4GHz band.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                  <test> Non-standard channel frequencies 
                    <steplist>
                      <step>Configure the TSF to monitor the channels as selected in the SFR.</step>
                      <step>Deploy AP on at least 2 different channels on non-standard channel frequencies.</step>
                      <step>Verify that the AP gets detected on each channel tested.</step>
                    </steplist>
                  </test>
                </testlist>
                
                <h:b>Wireless Sensor Transmission of Data</h:b><h:br/><h:br/>
                If the TOE provides the ability to disable wireless transmission, the evaluator shall follow the operational guidance to configure the sensor to not
                transmit wirelessly. The evaluator shall then deploy a signal analyzer in order to check for wireless emanations from the TOE. <h:br/>   
                Repeat the two tests below, for both the 2.4GHz and the 5 GHz band.
                <testlist>                  
                  <test>
                    <steplist>
                      <step>Boot a sensor and using the signal analyzer observe to check if any
                        eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the
                        sensor.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>During normal sensor operations, observe the analyzer for about 10
                        minutes to check if any eminations are coming from the sensor.</step>
                      <step>Verify that the signal analyzer does not pick up emanations from the
                        sensor.</step>
                    </steplist>
                  </test>
                </testlist>               
                
                
                
                <testlist>
                  <test>
                    <h:b>MAC Spoofing</h:b>
                    <steplist>
                      <step>Spoof mac address of whiteliste EUD connected to a whitelisted AP on a
                        second EUD. </step>
                      <step>Connect EUD with spoofed MAC address to another whitelisted AP while the
                        valid EUD it is spoofing is connected to the first AP. </step>
                      <step>Verify that the TSF detected the MAC spoofing.</step>
                    </steplist>
                  </test>
                  <test>
                    <h:b>MAC Spoofing</h:b>
                    <steplist>
                      <step>Spoof mac address of whiteliste AP on a second AP. </step>
                      <step>Verify that the TSF detected the MAC spoofing.</step>
                    </steplist>
                  </test>
                  
                  <test>
                    <h:b>Active Probing</h:b>
                    <steplist>
                      <step>Perform an active scan on the subnet of the WLAN.</step>
                      <step>Record tools used and type of scan performed. </step>
                      <step> Verify that the TSF detects the active probing.</step>
                    </steplist>
                  </test>
                  
                  <test>
                    <h:b>Point-to-Point Wireless Bridges</h:b>
                    <steplist>
                      <step>Setup a point-to-point wireless bridge using whitelisted APs in the
                        range of the wireless sensors.</step>
                      <step>Verift that the TSF detects the bridge.</step>
                    </steplist>
                  </test>
                  
                  <test>
                    <h:b>NULL Client Associations</h:b>
                    <steplist>
                      <step>Deploy whitelisted AP.</step>
                      <step>Configure the AP to have null SSID.</step>
                      <step>Attempt to connect a whitelisted EUD to the AP without supplying the
                        correct AP SSID.</step>
                      <step>Verify that the AP does not permit the EUD to complete an association by
                        returning a Probe Request.</step>
                      <step>If an association does occur, confirm that an alert is triggered due to
                        a violation of policy.</step>
                    </steplist>
                  </test>
                </testlist>
                <h:b>Stateful Frame Inspection</h:b>
                <testlist>               
                  <test>
                    <steplist>
                      <step>Deploy whitelisted AP.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Deploy a protocol analyzer (e.g. Wireshark) or native capability within
                        the WIDS Controller between the AP and EUD.</step>
                      <step>Verify from the network traffic packet capture that all frames are being
                        inspected to validate their connection state from the TSF</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Denial of Service" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.3" name="Wireless Intrusion Detection – Denial of Service"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> 
              The TSF shall detect RF-based denial of service, deauthentication flooding, disassociation flooding, request-to-send/clear-to-send abuse, and <selectables><selectable><assignable>other DoS methods</assignable></selectable><selectable>no other DoS methods</selectable></selectables>.
            </title>
            <aactivity>
              <TSS> 
                The evaluator shall examine the TSS to verify that it describes the denial of
                service attacks that can be detected by the TOE.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                If the ability of the TOE to detect different types of denial of service
                attacks is configurable, the evaluator shall verify that the operational guidance
                provides instructions on how to specify the attack(s) that are
                detected.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <!-- Later_Justin: Do we need a specific test for RTS/CTS abuse? -->
                <testlist>                  
                  <test>
                    <h:b>RF-based DoS</h:b>
                    <steplist>
                      <step>Deploy a whitelisted AP and configure to stay in a particular channel.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Use an RF Jammer or signal generator on the same frequency as the AP and EUD to create a RF-based DoS.</step>
                      <step>Verify that the TOE detects the RF-based DoS.</step>
                    </steplist>
                  </test>
                  <test> 
                    <h:b>Deauthentication Flood</h:b>
                    <steplist>
                      <step>Deploy whitelisted AP and configure to a set channel.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Send an flood of deauthentication frames to the EUD using the MAC
                        address of whitelisted AP it is connected to.</step>
                      <step>Verify that the TSF detects the deauthentication flood.</step>
                    </steplist>
                  </test>
                  <test>
                    <h:b>Deauthentication Flood</h:b>
                    <steplist>
                      <step>Deploy whitelisted AP and configure to a set channel.</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Send an flood of deauthentication frames with the MAC address of
                        whitelisted AP as the source and destination as a broadcast.</step>
                      <step>Verify that the TSF detects the deauthentication flood.</step>
                    </steplist>
                  </test> 
                  <test> 
                    <h:b>Dissasociation Flood</h:b>
                    <steplist>
                      <step>Deploy whitelisted AP and configure to a set channel.</step>
                      <step>Connect two whitelisted EUDs to the AP.</step>
                      <step>Send an flood of CTS frames to reserve RF medium.</step>
                      <step>Verify that the TSF detects the CTS abuse.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Unauthorized Authentication Schemes" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.4" name="Wireless Intrusion Detection – Unauthorized Authentication Schemes"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <!-- Moved this element to FMT_SMF -->
          <!--  <f-element> 
            <title> 
              The TSF shall provide Authorized Administrators the ability to define authorized WLAN authentication schemes. 
            </title>           
          </f-element>-->
          <f-element>
            <title> 
              The TSF shall detect when whitelisted APs and EUDs attempt to use WLAN authentication schemes that are not authorized. 
            </title>
            <note role="application">
              Whitelisted APs and EUDs are defined in FMT_SMF.1.            
            </note>
            <aactivity> 
              <TSS>                 
                The evaluator shall verify that the TSS describes the ability of the TOE to
                detect when unauthorized WLAN authentication schemes are used.<h:br/><h:br/>
              </TSS>
              <Guidance>
                The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN authentication scheme as authorized or
                unauthorized for the purposes of detection.<h:br/><h:br/>               
              </Guidance>
              <Tests> 
                The evaluator shall configure the TOE, per FMT_SMF.1, with 802.1x authentication as the only
                mode of authorized WLAN authentication scheme.
                <testlist>                             
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP with open authentication.</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the AP and the EUD using unauthorized
                        authentication schemes. </step>                     
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP that uses pre-shared key authentication.</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the AP and the EUD using unauthorized
                        authentication schemes.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Unauthorized Encryption Schemes" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.5" name="Wireless Intrusion Detection – Unauthorized Encryption Schemes"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <!-- Change: Moved this element to FMT_SMF -->
          <!--  <f-element>
            <title> The TSF shall provide Authorized Administrators the ability to define authorized
              WLAN encryption schemes. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the ability of the TOE to
                allow authorized administrators to define authorized WLAN encryption
                schemes.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN encryption scheme as authorized or
                unauthorized for the purposes of detection.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall configure the TSF with a set of allowed encryption
                schemes. The ability to detect violation of this policy will be tested in FAU_WID_EXT.5.2. </Tests>
            </aactivity>
          </f-element>-->
          <f-element>
            <title> The TSF shall detect when whitelisted APs and EUDs attempt to use WLAN encryption schemes that are not authorized.</title>
            <note role="application"> 
              Whitelisted APs and EUDs are defined in FMT_SMF.1.
            </note>         
          </f-element>
          <f-element>
            <title> 
              The TSF shall detect when whitelisted APs and EUDs send or receive unencrypted data.</title>
            <note role="application"> 
              Whitelisted APs and EUDs are defined in FMT_SMF.1.
              When referring to unencrypted data being received by a whitelisted AP or EUD it refers to unencrypted data being sent to a whitelisted AP or
              EUD from either a non-whitelisted or whitelisted AP or EUD.</note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS describes the ability of the TOE to
                detect when unauthorized WLAN encryption schemes are used.             
                The evaluator shall verify that the TSS describes the ability of the TOE to
                detect when unauthorized APs and EUDs send or receive unencrypted data.
                <h:br/><h:br/>
              </TSS>
              <Guidance> 
                There are no operational guidance activities.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>                
                  <test>
                    <steplist>
                      <step>Configure the TOE with 128 bit AES encryption type as the
                        only allowed encryption scheme.</step>
                      <step>Deploy a whitelisted AP with no encryption.</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Verify that the TOE detects the AP and the EUD using unauthorized
                        encryption schemes.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Configure the TOE with 128 bit AES encryption type as the
                        only allowed encryption scheme.</step>
                      <step>Deploy a whitelisted AP that uses TKIP encryption only.</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Verify that the TSF detects the AP and the EUD using unauthorized
                        encryption schemes.</step>
                    </steplist>
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP with no encryption.</step>
                      <step>Connect a whitelisted EUD to AP and generate traffic.</step>
                      <step>Verify that the TOE detects unencrypted data frames being sent between
                        the whitelisted AP and EUD.</step>
                      <step>Connect a non-whitelisted EUD to AP and generate traffic.</step>
                      <step>Verify that the TSF detects unencrypted data frames being sent between
                        the whitelisted AP and non-whitelisted EUD.</step>
                    </steplist>                   
                  </test>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP with no encryption.</step>
                      <step>Connect a whitelisted EUD to AP and generate traffic.</step>
                      <step>Verify that the TSF detects unencrypted data frames being between the
                        non-whitelisted AP and whitelisted EUD.</step>
                    </steplist>                  
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      
      <!-- TODO: Look at FAU_SAR, should probably add all three elements -->
      
      </sec:man_fau>
      
      <sec:fdp title="User Data Protection (FDP)">
        <f-component cc-id="fdp_ifc.1" name="Information Flow Control Policy"> <!-- DONE -->
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall enforce the <h:i>[802.11 monitoring SFP]</h:i> on <h:i>[all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:</h:i>
              <h:ul>
                <h:li><h:i>authorized APs and authorized EUDs </h:i></h:li>
                <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                <h:li><h:i>unauthorized APs and authorized EUDs</h:i>].</h:li>
              </h:ul>
            </title>
            <note role="application">
              “Authorized” EUDs/APs are those that are assigned to the whitelist as defined by FMT_SMF.1. <h:br/><h:br/> 
              The "802.11 monitoring SFP" is a security function policy and the SFRs that reference this policy describe what the policy does. The "802.11 monitoring SFP" is established in FDP_IFC.1 and defined through the FAU_WID_EXT SFRs. A vendor does not have to formally define this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS> There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> If this functionality is configurable, the evaluator shall verify that the
                operational guidance provides instructions on how to configure the TOE to monitor
                different types of IEEE 802.11 frame types and subtypes.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <h:ul>
                      <h:li>Set the WIDS sensor for a set channel</h:li>
                      <h:li>Start a traffic capture from the WIDS sensor</h:li>
                      <h:li>Send a set number of frames on the sensor's operating
                        channel for all IEEE 802.11 a, b, g, n, ac frame types and subtypes from/to
                        the following: <h:ul>
                          <h:li><h:i>authorized APs and authorized EUDs</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs</h:i></h:li>
                        </h:ul></h:li>
                      <h:li>Verify that there are frames from all the types and subtypes in the
                        capture. </h:li>
                    </h:ul>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:fdp>
      
      <sec:fmt title="Security Management (FMT)">
        <f-component cc-id="fmt_smf.1" name="Specification of Management Functions (WIDS)" iteration="WIDS"> <!-- TODO: Need to finish EA. Can simply say that these functions shall be tested in conjunction of the other components listed below-->
          <consistency-rationale/>
          <f-element> <!-- Later_Justin: Anyother current requirements that would require configuration? Any other capabilities that we would want to manage. -->
            <title> The TSF shall be capable of performing the following management functions for WIDS functionality: <h:ul>
              <h:li>Define an inventory of authorized APs based on MAC addresses,</h:li> <!-- FAU_INV_EXT.1.1 --> <!-- Done -->
              <h:li>Define an inventory of authorized EUDs based on MAC addresses,</h:li> <!-- FAU_INV_EXT.1.1 --> <!-- Done -->
              <h:li>Define rules for monitoring and alerting on the wireless traffic,</h:li> <!-- FAU_SAA.1.1 --> <!-- Add to SAA.1.1 note about overlap -->
              <h:li>Define authorized SSID(s),</h:li> <!-- FAU_WID_EXT.2.3 -->
              <h:li>Define authorized WLAN authentication schemes,</h:li> <!-- FAU_WID_EXT.4.1 -->
              <h:li>Define authorized WLAN encryption schemes,</h:li><!--FAU_WID_EXT.5.1  -->
             <!--  <h:li>the management (addition, removal, or modification) of actions</h:li>-->  <!-- FAU_ARP.1 -->
              <h:li><selectables>              
                <selectable>Specification of periods of network activity that constitute baseline of expected behavior</selectable> <!-- FAU_ANO_EXT.1-->
                <selectable>Definition of anomaly activity</selectable><!-- FAU_ANO_EXT.1.2 -->
                <selectable>Define classification rules to detect rogue APs</selectable><!-- FAU_WID_EXT.1.1 -->
                <selectable><selectables><selectable>Enable</selectable><selectable>Disable</selectable></selectables> transmission of data by wireless sensor</selectable><!-- FAU_WID_EXT.2.2 -->
                <selectable>Define attack signatures</selectable><!-- FAU_SIG_EXT.1.1 -->
                <selectable>Define rules for overwriting previous packet captures</selectable><!-- FAU_STG_EXT.1.3/PCAP -->
                <selectable>Define the amount of time sensor monitors a specific <selectables>
                  <selectable>frequency</selectable>
                  <selectable>channel</selectable>
                </selectables></selectable>
                <selectable>no other capabilities</selectable>            
              </selectables>.</h:li>
            </h:ul>
            </title>
            <note role="application">
              Define authorized WLAN authentication and encryption schemes does not enforce, but rather establishes a baseline to determine if an unauthorized scheme is used.<h:br/><h:br/>
              If FAU_ANO_EXT.1 is included in the ST, "Specification of periods of network activity that constitute baseline of expected behavior" shall be selected. If FAU_ANO_EXT.1 is included in the ST and "manual configuration by administrators" is selected in FAU_ANO_EXT.1, then "Definition of anomaly activity" shall be selected.<h:br/><h:br/>
              
              If "can be configured to prevent transmission of data" is selected in FAU_WID_EXT.2 then "Enable/Disable transmission of data by wireless sensor" shall be selected.<h:br/><h:br/>
              It is expected that an Authorized Administrator will be
              responsible for configuring the AP to operate on a specific frequency persuaent to the
              802.11 standard. The TSF will have the ability to adjust the amount of time it
              passively monitors and captures WLAN traffic on a given frequency and channel. 
              </note>
            <aactivity>
              <!-- TODO: Add EAs for new functions. Current EA is just for the configuration of time spent on frequency and/or channel  -->
              <!-- Stuff pulled from other EAs
              FMT_SMF

The evaluator shall review the TSS to verify that it includes information the
                ability of the TOE to define inventory of authorized APs and EUDs.<h:br/><h:br/> 

<Guidance> 
                The evaluator shall review the operational guidance for instructions on how
                to configure and change clasification of APs and EUDs to indicate that they are part
                of the whitelist.<h:br/><h:br/> 


The administrator should have the ability to configure which SSIDs are permitted on the network.

The evaluator shall verify that the TSS describes the ability of the TOE to
                allow authorized administrators to define authorized WLAN authentication
                schemes.<h:br/><h:br/>

The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN authentication scheme as authorized or
                unauthorized for the purposes of detection.<h:br/><h:br/>


<aactivity>
              <TSS> The evaluator shall verify that the TSS describes the ability of the TOE to
                allow authorized administrators to define authorized WLAN encryption
                schemes.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall examine the operational guidance to verify that it
                provides instructions on how to define a WLAN encryption scheme as authorized or
                unauthorized for the purposes of detection.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall configure the TSF with a set of allowed encryption
                schemes. The ability to detect violation of this policy will be tested in FAU_WID_EXT.5.2. </Tests>
            </aactivity>

              
              
              
              
              -->
              
              
              
              
              <TSS> 
                The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them.
                <h:br/><h:br/>
              </TSS>
              <Guidance> 
                There are no operational guidance activities for this SFR.
                <h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm that the TSF can observe and capture traffic and events
                        generated by the AP.</step>
                      <step>Verify that the TSF can be configured to capture traffic on a specific
                        channel for specific interval of time, and assign a specified frequency and
                        time interval.</step>
                      <step>Confirm that the TSF" /> remains on the frequency and channel for the
                        time period specified.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:fmt>
    </man-sfrs>
    <opt-sfrs>
      <sec:opt_fau title="Security Audit (FAU)">
        <ext-comp-def title="Wireless Spectrum Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.6" name="Wireless Intrusion Detection – Non-Wireless Spectrum Monitoring"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the presence of network devices that operate in the
              following RF bands: <selectables>
                <selectable>3.6 GHz</selectable>
                <selectable>60 GHz</selectable>
                <selectable>sub-GHz (0-900 MHz)</selectable>
                <selectable id="cell">all cellular bands</selectable>
              </selectables>.
            </title>
            <ext-comp-def-title>
            <title> The TSF shall detect the presence of network devices that operate in the
              following RF bands: <assignable>some bands</assignable>.
            </title>
            </ext-comp-def-title>
            <note role="application"> This SFR refers to Non-Wi-Fi (IEEE 802.11 a, b, g, n, and ac)
              network devices that operate in the specified frequencies. If the ST author selects
              detection of devices in the cellular bands, FAU_INV_EXT.4 must
              be included in the ST. </note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes the set of RF bands and
                technologies that the TSF can detect the use of. The TSS should also include
                instructions on how to enable and the hardware that is necessary for the additional
                band detection. <h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall verify that the operational guidance describes how to
                enable and configure detection of the technologies included in the ST as well as the
                hardware that is needed to perform this function.<h:br/><h:br/>
              </Guidance>
              <Tests> 
                The evaluator shall enable and configure detection of the selected
                technologies. 
                <testlist>
                  <test>Deploy a device within the given technology and verify that the TSF detects
                    the device.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
          
        <ext-comp-def title="Wireless Spectrum Monitoring" fam-id="FAU_WID_EXT"><!-- Changed: Split elements into two components. This is new component  -->
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.7" name="Wireless Intrusion Detection – Wireless Spectrum Analysis"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
        <f-element>
            <title> The TSF shall provide a dedicated sensor for wireless spectrum analysis. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS to verify that the TOE provides a
                dedicated sensor for wireless spectrum analysis.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                enable and configure dedicated spectrum analysis as well as the hardware that is
                needed to perform this function.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall enable and configure dedicated spectrum analysis and test
                the capabilities listed in the TSS. </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:opt_fau>
    </opt-sfrs>
    
    <sel-sfrs>
      <sec:sel_fau title="Security Audit (FAU)">
        <ext-comp-def title="Anomaly-Based Intrusion Detection" fam-id="FAU_ANO_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_ano_ext.1" name="Anomaly-Based Intrusion Detection"> <!-- DONE -->
          <selection-depends req="fel-ids-meth" ids="anoBased"/>
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall support the definition of <selectables>
              <selectable>baselines (‘expected and approved’)</selectable>
              <selectable>anomaly (‘unexpected’) traffic patterns</selectable>
            </selectables> including the specification of <selectables linebreak="yes">
              <selectable>throughput (data elements (e.g. bytes, packets, etc.) per time period (e.g. minutes, hours, days))</selectable>             
              <selectable>time of day</selectable>
              <selectable>frequency</selectable>
              <selectable>thresholds</selectable>
              <selectable><assignable>other methods</assignable></selectable>
            </selectables> and the following network protocol fields: <h:ul>
              <h:li>all management and control frame header elements.</h:li>
            </h:ul>
            </title>
          </f-element>
          <f-element>
            <title> The TSF shall support the definition of anomaly activity through <selectables>
              <selectable>manual configuration by administrators</selectable>
              <selectable>automated configuration</selectable>
            </selectables>. </title>
            <note role="application"> The “baseline” and “anomaly” can be something manually
              defined/configured by a TOE administrator (or importing definitions), or something
              that the TOE is able to automatically define/create by inspecting network traffic over
              a period of time (a.k.a. “profiling”). </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the composition and
                construction of baselines or anomaly-based attributes specified in the SFR. The
                evaluator shall verify that the TSS provides a description of how baselines are
                defined and implemented by the TSF, or a description of how anomaly-based rules are
                defined and configured by the administrator. <h:br/><h:br/> The evaluator shall
                verify that the TSS describes the available modes of configuration (manual or
                automatic) and how to configure or import the baseline.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance describes how to
                configure baseline and/or anomalous traffic patterns based on what is stated in the
                TSS.<h:br/><h:br/> The evaluator shall verify that the operational guidance
                describes how to perform automatic and/or manual definition of anomaly activity
                based on what is selected in the ST.<h:br/><h:br/>
              </Guidance>
              <Tests> The evaluator shall use the instructions in the operational guidance to
                configure baselines or anomaly-based rules through automated and/or manual means
                based on what is selected in the ST. The evaluator shall send traffic that does not
                match the baseline or matches the anomaly-based rule and verify the TSF detects the
                anomalous behavior and generates an alert. </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <!-- Removed - commented out for now -->
        <!--  <ext-comp-def title="Location of Environmental Objects (Cellular Devices)"
          fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component name="Location of Environmental Objects (Cellular Devices)" id="fau_inv_ext.4" iteration="CELL"> 
          <selection-depends req="fau_wid_ext.6.1" ids="cell"/>
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> 
              The TSF shall detect the physical location of cellular devices to within <assignable>distance degree of accuracy</assignable> of their actual location.
            </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes information on the TOE’s
                ability to detect the physical location of cellular devices.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to configure location tracking, how to load a location map (if applicable), and
                where in the TSF administrator interface the location of devices can be
                viewed.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a cellular device within range of the sensors.</step>
                      <step>Verify that the TSF is able to track the location of the device.</step>
                      <step>Verify the level of accuracy indicated by the TSF falls within the one
                        indicated in the assignment.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        -->
       
        <ext-comp-def title="Signature-Based Intrusion Detection" fam-id="FAU_SIG_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_sig_ext.1" name="Signature-Based Intrusion Detection"><!-- DONE -->
          <selection-depends req="fel-ids-meth" ids="sigBased"/>
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall support user-defined and customizable attack signatures. </title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS describes the user-defined and
                customizable attack signatures that the TOE can define.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall verify that the operational guidance provides
                information on how to configure user-defined and customizable attack signatures,
                including a description of the customization options that are
                available.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Craft a signature with the available fields indicated in the TSS.</step>
                      <step>Send a crafted frame that matches the signature to a whitelisted
                        EUD</step>
                      <step>Verify that the TSF triggers an alert based on the newly defined
                        signature.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <ext-comp-def title="Protected Audit Event Storage (Packet Captures)" fam-id="FAU_STG_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_stg_ext.1" iteration="PCAP" name="Protected Audit Event Storage (Packet Captures)"> <!-- Later_TODO: Look at 1.2 in ND -->
          <!-- This component is copied from ND cPP and iterated to make a distintion between audit records and PCAPs -->
          <selection-depends req="fel-arp" ids="pcap"/> <!-- fau_arp.1.1 -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title>The TSF shall be able to transmit the generated packet captures to an external IT entity using a trusted channel according to FTP_ITC.1. </title>
            <note role="application"> 
              Per FAU_STG_EXT.1 in the Base-PP, the TOE must support transfer of the audit data to an external IT entity using a trusted channel per FTP_ITC.1. Note that this PP-Module modifies FTP_ITC.1 from the Base-PP. If "capture raw frame traffic that triggers the violation" is selected in FAU_ARP.1, then this SFR shall be included in the ST, and this iteration is for the PCAPs generated as a selectable action completed upon detection of a potential security violation in FAU_ARP.1.
               </note>
          </f-element>
          <f-element> <!-- Later_TODO: Look at this element in NDcPP -->
            <title>The TSF shall be able to store generated packet captures on the TOE itself. </title>
          </f-element>
          <f-element>
            <title> The TSF shall <selectables>
              <selectable>drop new packet capture data</selectable>
              <selectable>overwrite previous packet captures according to the following rule: <assignable>rule for overwriting previous packet captures</assignable>
              </selectable>
              <selectable>
                <assignable>other action</assignable>
              </selectable>
            </selectables> when the local storage space for packet capture data is full. </title>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS includes the list of trusted channels (as specified in FTP_ITC.1) available in the TSF to transmit packet captures to an external entity. The evaluator shall verify that the TSS describes the ability of the TOE to store packet capture data within itself, how much storage space is available for packet capture data and where that data is stored. The evaluator shall verify that the TSS describes the behavior of the TOE when local storage space for packet capture data is exhausted and whether this behavior is configurable.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall verify that the operational guidance provides instructions on how to configure the trusted channel. If the behavior of the TOE when local storage space for packet capture data is exhausted is configurable, the evaluator shall verify that the operational guidance provides information on what the configurable behaviors are and how they can be set.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>The evaluator shall configure packet captures according to the guidance specified. The evaluator shall then trigger an event that starts a capture and verify through the tests in FTP_ITC.1 that the captured traffic being sent to the external device is being sent through a trusted channel.</test>
                  <test>The evaluator shall configure packet captures to be stored on the TSF according to the guidance specified. The evaluator shall then trigger an event that starts a capture and verify that the packet capture was stored on the TSF.</test>
                  <test>The evaluator shall define packet data retention and deletion rules on the TSF according to the guidance specified and test the functionality of the specified rules.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:sel_fau>
    </sel-sfrs>
    <obj-sfrs>
      <sec:obj_fau title="Security Audit (FAU)">
        <ext-comp-def title="Detection of Unauthorized Connections" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.5" name="Detection of Unauthorized Connections"><!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect when non-whitelisted APs have a wired connection to the internal corporate network.</title>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes guidance on whether the TSF has
                the capability of detecting APs connecting to the protected wired network
                infrastructure. If the capability is present the TSS shall include configuration
                guidance for this feature.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance for instructions on how
                to configure the WIDS to detect unauthorized APs connected to the protected wired
                infrastructure.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP.</step>
                      <step>Connect the AP via wire to the protected network infrastructure.</step>
                      <step>Check the WIDS user interface for a list of detected APs and
                        EUDs.</step>
                      <step>Verify that the rogue AP is detected and an alert generated on the
                        detection of an AP connected to the protected wired infrastructure.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
          
        <!-- NEW Component --> 
        <ext-comp-def title="Signal Library" fam-id="FAU_INV_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_inv_ext.6" name="Signal Library"> <!-- DONE -->
          <consistency-rationale></consistency-rationale>
          <f-element>
            <title> The TSF shall include a signal library.</title>
            <note role="application">The TSF will need to have the ability to import, export, or
              update the exisiting signal library.</note>   
            <aactivity> 
              <TSS>             
                There are no TSS assurance activities for this SFR.
              </TSS>
              <Guidance> 
                The evaluator shall review the operational guidance for instructions on how
                to locate and verify that the WIDS comes preloaded with a signal library, as well as 
                possesses the ability to import, export, and update the existing signal library if present.<h:br/><h:br/>
              </Guidance>
              <Tests>
                Depending on operation guidance provided for the TOE, the
                evaluator shall confirm and note the existence of the signal library, and test for the
                ability to import, export, and update the signal library.
                <!-- DONE: Justin: Look at this and modify if needed. -->
                <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a whitelisted AP and connect it to the protected wired
                        infrastructure via wire.</step>
                      <step>Confirm and note whether the TSF has an existing signal library.</step>
                      <step>If existence is confirmed, verify that the TSF can import, export, and update the existing signal library.</step>
                    </steplist>
                  </test>
                </testlist>              
              </Tests>
            </aactivity> 
          </f-element>
        </f-component>
        
        <ext-comp-def title="Device Impersonation" fam-id="FAU_MAC_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_mac_ext.1" name="Device Impersonation"> <!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> 
              The TSF shall detect when two sensors in non-overlapping locations receive
              traffic from the same MAC address simultaneously.</title>
            <note role="application">
              The intent of this SFR is to detect MAC spoofing where an
              attacker is able to cause the whitelisted EUD to disconnect and promptly connects a
              non-whitelisted device using the MAC address of the whitelisted EUD.</note>
          </f-element>
          <f-element>
            <title> The TSF shall detect when two sensors in non-overlapping locations receive
              traffic from the MAC addresses of non-whitelisted EUDs within an Authorized administrator-configurable timeframe based on distance between sensors.</title>
            <note role="application">The intent of this SFR is to allow the administrator to
              determine the time that should be allowed between a whitelisted EUD connecting in two
              distant locations.</note>
            <aactivity>
              <TSS> 
                The evaluator shall verify that the TSS describes the behavior of the TOE when
                two sensors in non-overlapping locations receive traffic from the same MAC address
                simultaneously.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                The evaluator shall verify that the operational guidance provides
                instructions on how to deploy the TOE in a manner that allows the TSF to detect when
                two sensors in non-overlapping locations receive traffic from the same MAC address
                simultaneously (i.e. information about the range and placement of sensors to ensure
                non-overlapping coverage).<h:br/><h:br/>
                The evaluator shall verify that the operational guidance provides
                instructions on how to configure the timeframe that should be allowed between two
                subsequent attempts for an EUD to connect from two separate locations.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Setup a whitelisted AP (Location 1).</step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Setup a second whitelisted AP and a non-whitelisted EUD in a separate
                        non-overlapping location where the WIDS also has sensors. Or simulate the
                        distant non-verlapping locations by deploying the second AP in a shielded
                        environment connected to the valid network (Location 2).</step>
                      <step>Spoof the MAC address of the EUD in location 1 with the EUD in location
                        2 and connect it to the whitelisted AP in location 2. Make sure both EUDs
                        are connected at the same time.</step>
                      <step>Verify that the TSF detected and generated an alert.</step>
                    </steplist>
                  </test>
                
                  <test>
                    <steplist>
                      <step>Configure the timeframe allowed between connection of two EUDs in two
                        separate locations (Location 1, Location 2).</step>
                      <step>Setup a whitelisted AP (Location 1). </step>
                      <step>Connect a whitelisted EUD to AP.</step>
                      <step>Setup a second whitelisted AP and a non-whitelisted EUD in a separate
                        non-overlapping location where the WIDS also has sensors. Or simulate the
                        distant non-verlapping locations by deploying the second AP in a shielded
                        environment connected to the valid network (Location 2).</step>
                      <step>Spoof the MAC address of the EUD in location 1 with the EUD in location
                        2 and connect it to the whitelisted AP in location 2. Make sure that the
                        time between connections is shorter than the time timeframe
                        allowed/configured. </step>
                      <step>Verify that the TSF detected and generated an alert.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        
        <!-- Removed-->        
        <!-- <ext-comp-def title="Proprietary Traffic Monitoring" fam-id="FAU_WID_EXT">
          <mod-def/>
        </ext-comp-def>
        <f-component cc-id="fau_wid_ext.8" name="Wireless Intrusion Detection – Proprietary Traffic Monitoring">
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall detect the presence of all vendor proprietary network traffic
              matching the 802.11 monitoring SFP for all IEEE 802.11 a, b, g, n, ac frame types and subtypes between:
              <h:ul>
                <h:li>authorized APs and authorized EUDs</h:li>
                <h:li>authorized APs and unauthorized EUDs</h:li>
                <h:li>unauthorized APs and authorized EUDs.</h:li>
              </h:ul></title>
            <note role="Application">
              The "802.11 monitoring SFP" is a security function policy and
              the SFRs that reference this policy describe what the policy does. The "802.11
              monitoring SFP" is established in FDP_IFC.1> and defined through the 
             FAU_WID_EXT SFRs. A vendor does not have to formally define
              this policy, it only needs to comply with the SFRs.</note>
            <aactivity>
              <TSS> 
                There are no TSS assurance activities for this SFR.<h:br/><h:br/>
              </TSS>
              <Guidance> 
                There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>
                    <steplist>
                      <step>Set the WIDS sensor for a set channel.</step>
                      <step>Start a traffic capture from the WIDS sensor.</step>
                      <step>Send a set number of frames on the sensor's operating channel for all
                        IEEE 802.11 a, b, g, n, ac vendor propietary frame types and subtypes
                        from/to the following: <h:ol>
                          <h:li><h:i>authorized APs and authorized EUDs.</h:i></h:li>
                          <h:li><h:i>authorized APs and unauthorized EUDs.</h:i></h:li>
                          <h:li><h:i>unauthorized APs and authorized EUDs.</h:i></h:li>
                        </h:ol>
                      </step>
                      <step>Provide a list of the frames types and subtypos that were used for
                        testing and verify that they were all detected.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
        -->
        
        <ext-comp-def title="Wireless Intrusion Prevention" fam-id="FAU_WIP_EXT">
          <fam-behavior/>
        </ext-comp-def>
        <f-component cc-id="fau_wip_ext.1" name="Wireless Intrusion Prevention"><!-- DONE -->
          <consistency-rationale/>
          <comp-lev/>
          <management/>
          <audit/>
          <dependencies/>
          <f-element>
            <title> The TSF shall allow an Authorized Administrator to isolate a wireless AP or EUD
              from the network monitored by the TSF using the following methods: <selectables>
                <selectable>wireless containment</selectable>
                <selectable>wire-side containment of an unauthorized AP connected to the internal
                  corporate wired network.</selectable>
              </selectables>
            </title>
            <note role="application">It is expected that an Authorized Administrator will be
              responsible for confirming the AP or EUD as a rogue AP or EUD to initiate wireless
              containment. <h:br/> In this SFR the containment of an an unauthorized AP connected to
              the internal corporate wired network refers to an unauthorized AP that is physically
              connected (via wire) to the protected internal wired infrastructure. </note>
            <aactivity>
              <TSS> The evaluator shall verify that the TSS includes a list of available containment
                methods on the TSF and how to configure them.<h:br/><h:br/>
              </TSS>
              <Guidance> There are no operational guidance activities for this SFR.<h:br/><h:br/>
              </Guidance>
              <Tests> Configure the containment methods available on the TSF and perform the
                following test for each method. <testlist>
                  <test>
                    <steplist>
                      <step>Deploy a non-whitelisted AP and connect to the protected wired
                        infrastructure via wire (make sure it gets classified as rogue, or manually
                        classify as such).</step>
                      <step>Connect a whitelisted EUD to the AP.</step>
                      <step>Verify that TSF generates an alert, breaks the connection of the
                        whitelisted EUD from the rogue AP, and contains the rogue AP.</step>
                    </steplist>
                  </test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:obj_fau>
      
      <sec:fpt title="Protection of the TSF (FPT)">
        <f-component cc-id="fpt_fls.1" name="Basic Internal TSF Data Transfer Protection"> <!-- DONE -->
          <consistency-rationale/>
          <f-element>
            <title> The TSF shall preserve a secure state when the following types of failures occur: [<h:i>sensor functionality failure, potential compromise of the TSF</h:i>]. </title>
            <note role="application"> 
              At minimum, the preservation of a secure state requires the generation of audit records when the defined failure conditions occur. </note>
            <aactivity>
              <TSS> The evaluator shall review the TSS section to determine that the TOE’s implementation of the fail secure functionality is documented. The evaluator shall examine the TSS section to ensure that all failure modes specified in the ST are described.<h:br/><h:br/>
              </TSS>
              <Guidance> The evaluator shall review the operational guidance to verify that it identifies the potential TOE failures, how the TSF preserves a secure state following these failures, and any actions that are required to restore the TOE to normal operation following the transition to a failure state. <h:br/><h:br/>
              </Guidance>
              <Tests>
                <testlist>
                  <test>For each failure mode specified in the ST, the evaluator shall ensure that the TOE attains a secure state after initiating each failure mode type.</test>
                </testlist>
              </Tests>
            </aactivity>
          </f-element>
        </f-component>
      </sec:fpt>
    </obj-sfrs>
  </sec:Security_Requirements>
  <appendix id="my_appendix" title="An Example Appendix">
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
  </appendix>

  <bibliography>
    <cc-entry/>
  </bibliography>
  <acronyms/>
</Module>



